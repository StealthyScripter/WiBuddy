<div class="container py-6">
  <!-- Page Header -->
  <header class="page-header">
    <h1 class="page-title">Tasks</h1>
  </header>

  <!-- Search and Actions Bar -->
  <div class="search-actions">
    <div class="search-container">
      <input
        type="text"
        [(ngModel)]="searchQuery"
        placeholder="Search tasks..."
        (input)="filterTasks()"
        class="form-input"
        aria-label="Search tasks"
      />
      <button class="search-icon" aria-label="Search">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="11" cy="11" r="8"/>
          <path d="M21 21l-4.35-4.35"/>
        </svg>
      </button>
    </div>

    <div class="actions">
      <select
        [(ngModel)]="sortCriteria"
        (change)="sortTasks()"
        class="form-select"
        aria-label="Sort tasks"
      >
        <option value="priority">Sort by Priority</option>
        <option value="date">Sort by Date</option>
        <option value="status">Sort by Status</option>
      </select>

      <button class="btn btn-primary" (click)="addTask()">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M12 5v14M5 12h14"/>
        </svg>
        New Task
      </button>
    </div>
  </div>

  <!-- Tasks Grid -->
  <div class="tasks-grid">
    @for (task of filteredTasks; track task) {
      <div
        class="task-card"
        [ngClass]="getStatusClass(task.completionStatus)"
        (click)="navigateToTask(task.id)"
      >
        <div class="task-header">
          <h3 class="task-title">{{ task.name }}</h3>
          <span class="badge" [ngClass]="'badge-' + getStatusClass(task.completionStatus)">
            {{ getStatusDisplay(task.completionStatus) }}
          </span>
        </div>

        <p class="task-description">
          {{ task.description || 'No description provided' }}
        </p>

        <div class="task-footer">
          <div class="task-due-date" [ngClass]="{'overdue': isOverdue(task)}">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
              <path d="M16 2v4M8 2v4M3 10h18"/>
            </svg>
            <span>Due: {{ task.dueDate | date:'MMM dd' }}</span>
          </div>

          <div class="task-category">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"/>
              <circle cx="7" cy="7" r="1"/>
            </svg>
            <span>{{ task.category }}</span>
          </div>
        </div>

        <button
          (click)="toggleTaskComplete(task); $event.stopPropagation()"
          class="btn btn-sm mt-3"
          [ngClass]="task.isCompleted ? 'btn-secondary' : 'btn-success'"
        >
          {{ task.isCompleted ? 'Undo' : 'Complete' }}
        </button>
      </div>
    }

    <!-- Empty State -->
    @if (filteredTasks.length === 0) {
      <div class="empty-state">
        <div class="empty-state-icon">
          <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
            <path d="M14 2v6h6M16 13H8M16 17H8M10 9H8"/>
          </svg>
        </div>
        <div class="empty-state-title">No tasks found</div>
        <p class="empty-state-description">
          No tasks match your search criteria. Try adjusting your filters or create a new task.
        </p>
        <button class="btn btn-primary" (click)="addTask()">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M12 5v14M5 12h14"/>
          </svg>
          Create New Task
        </button>
      </div>
    }
  </div>
</div>
