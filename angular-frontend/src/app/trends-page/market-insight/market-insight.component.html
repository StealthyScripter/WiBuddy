<!-- market-insight.component.html - Unique Data Only -->
@if (!loading && marketData) {
  <div class="market-container">
    <!-- Header -->
    <div class="market-header-section">
      <button (click)="goBack()" class="back-button">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <polyline points="15 18 9 12 15 6"></polyline>
        </svg>
        Back
      </button>
      <div>
        <h1 class="market-page-title">Job Market Deep Dive</h1>
        <p class="market-page-subtitle">Detailed job listings and salary analysis</p>
      </div>
    </div>
    <!-- Main Content -->
    <div class="market-main">
      <div class="market-grid">
        <!-- Left Column - Job Listings ONLY -->
        <div class="market-left">
          <!-- Filter Bar -->
          <div class="filter-section">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="filter-icon">
              <polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"></polygon>
            </svg>
            @for (cat of categories; track cat) {
              <button
                (click)="selectedCategory = cat"
                [class.active]="selectedCategory === cat"
                class="filter-button">
                {{ cat | titlecase }}
              </button>
            }
          </div>
          <!-- Job Listings -->
          <div class="card">
            <h2 class="card-title">
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                <circle cx="12" cy="7" r="4"></circle>
              </svg>
              Open Positions ({{ getFilteredJobs().length }})
            </h2>
            <div class="jobs-list">
              @for (job of getFilteredJobs(); track job) {
                <div class="job-card-enhanced">
                  <div class="job-card-header">
                    <div>
                      <h3 class="job-title-enhanced">{{ job.title }}</h3>
                      <p class="job-company-enhanced">{{ job.company }}</p>
                    </div>
                    <span class="match-badge">{{ job.matchPercentage }}% match</span>
                  </div>
                  <p class="job-description-enhanced">{{ job.description }}</p>
                  <div class="job-meta-row">
                    <div class="meta-item">
                      <span class="meta-label">Location</span>
                      <span class="meta-value">{{ job.location }}</span>
                    </div>
                    <div class="meta-item">
                      <span class="meta-label">Salary</span>
                      @if (job.salary) {
                        <span class="meta-value">{{ job.salary }}</span>
                      }
                      @if (!job.salary) {
                        <span class="meta-value">Competitive</span>
                      }
                    </div>
                    <div class="meta-item">
                      <span class="meta-label">Posted</span>
                      <span class="meta-value">{{ job.postedDate }}</span>
                    </div>
                  </div>
                  <div class="job-skills-enhanced">
                    @for (skill of job.requiredSkills; track skill) {
                      <span class="skill-tag-enhanced">
                        {{ skill }}
                      </span>
                    }
                  </div>
                  <a [href]="job.link" target="_blank" class="job-link-button">
                    View on Job Board
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path>
                      <polyline points="15 3 21 3 21 9"></polyline>
                      <line x1="10" y1="14" x2="21" y2="3"></line>
                    </svg>
                  </a>
                </div>
              }
              @if (getFilteredJobs().length === 0) {
                <div class="empty-state-enhanced">
                  <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="11" cy="11" r="8"></circle>
                    <path d="m21 21-4.35-4.35"></path>
                  </svg>
                  <p>No opportunities found in this category</p>
                </div>
              }
            </div>
          </div>
        </div>
        <!-- Right Column - Salary Analysis & Market Breakdown -->
        <div class="market-right">
          <!-- Salary Range Analysis -->
          <div class="card">
            <h2 class="card-title">
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="12" y1="1" x2="12" y2="23"></line>
                <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
              </svg>
              Salary Ranges by Role
            </h2>
            <div class="salary-list-enhanced">
              @for (role of marketData.salaryInsight | keyvalue; track role) {
                <div class="salary-item-enhanced">
                  <div class="salary-role-enhanced">{{ role.key }}</div>
                  <div class="salary-amount-enhanced">{{ role.value }}</div>
                </div>
              }
            </div>
          </div>
          <!-- Job Distribution by Category -->
          <div class="card">
            <h2 class="card-title">
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="3" y="3" width="7" height="7"></rect>
                <rect x="14" y="3" width="7" height="7"></rect>
                <rect x="14" y="14" width="7" height="7"></rect>
                <rect x="3" y="14" width="7" height="7"></rect>
              </svg>
              Opportunities by Field
            </h2>
            <div class="distribution-list">
              <div class="distribution-item">
                <div class="distribution-header">
                  <span class="distribution-label">Frontend</span>
                  <span class="distribution-count">{{ (getFilteredJobs() | slice:0:10).length }}</span>
                </div>
                <div class="distribution-bar">
                  <div class="distribution-fill" [style.width.%]="(getFilteredJobs() | slice:0:10).length * 10"></div>
                </div>
              </div>
              <div class="distribution-item">
                <div class="distribution-header">
                  <span class="distribution-label">Backend</span>
                  <span class="distribution-count">8</span>
                </div>
                <div class="distribution-bar">
                  <div class="distribution-fill" [style.width.%]="80"></div>
                </div>
              </div>
              <div class="distribution-item">
                <div class="distribution-header">
                  <span class="distribution-label">DevOps</span>
                  <span class="distribution-count">5</span>
                </div>
                <div class="distribution-bar">
                  <div class="distribution-fill" [style.width.%]="50"></div>
                </div>
              </div>
              <div class="distribution-item">
                <div class="distribution-header">
                  <span class="distribution-label">Data Science</span>
                  <span class="distribution-count">6</span>
                </div>
                <div class="distribution-bar">
                  <div class="distribution-fill" [style.width.%]="60"></div>
                </div>
              </div>
            </div>
          </div>
          <!-- Your Match Score -->
          <div class="card match-score-card">
            <h2 class="card-title">
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2z"></path>
                <path d="M10 17l-4-4 1.41-1.41L10 14.17l6.59-6.59L18 9l-8 8z"></path>
              </svg>
              Your Market Fit
            </h2>
            <div class="match-metrics">
              <div class="match-metric">
                <div class="metric-label">Average Match Score</div>
                <div class="metric-value">82%</div>
                <div class="metric-bar">
                  <div class="metric-fill" style="width: 82%"></div>
                </div>
              </div>
              <div class="match-stat">
                <span class="stat-icon">âœ“</span>
                <span class="stat-text">You match 14 out of 18 positions</span>
              </div>
              <div class="match-stat">
                <span class="stat-icon">ðŸŽ¯</span>
                <span class="stat-text">Top opportunities in Frontend & Backend</span>
              </div>
            </div>
          </div>
          <!-- Market Health -->
          <div class="market-health-card">
            <h2 class="card-title">
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0z"></path>
                <path d="M9 9h.01M15 9h.01M9 15a4 4 0 0 0 6 0"></path>
              </svg>
              Market Health
            </h2>
            <div class="health-grid">
              <div class="health-item excellent">
                <div class="health-badge">Excellent</div>
                <div class="health-label">Job Availability</div>
              </div>
              <div class="health-item good">
                <div class="health-badge">Good</div>
                <div class="health-label">Salary Trends</div>
              </div>
              <div class="health-item excellent">
                <div class="health-badge">Excellent</div>
                <div class="health-label">Growth Potential</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
} @else {
  <div class="loading-container">
    <div class="spinner"></div>
    <p class="loading-text">Loading job market data...</p>
  </div>
}

<!-- Loading State -->
